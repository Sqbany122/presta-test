var sensbitinpost=function(c,e,t){var a={id_order:"",ajax_url_packages:"",next_package_id:1,google_key:"AIzaSyDZc6Ajf0PqhUAzbktozQyHFpi5V7TZW_o",callback_queue:{},open_single_template:!1,reload_page:!1,mass_page:!1,next_order:0};function r(e){var a={};return e.find(".param").each(function(e,t){var n="";n=c(this).is(":checkbox")?c(this).is(":checked")?1:0:c(this).val(),a[c(this).attr("name")]=n}),a}function i(e,t,n,a){a=void 0!==a&&a;e.parents(".messages-container");var i=e.find(".message");i.removeClass("success warning danger").addClass(n),i.html(t),i.fadeIn(),a&&setTimeout(function(){i.fadeOut()},1e3),c(".sensbitinpost .messages-container .message").each(function(){var e=c(this),t=e.parents("tr"),n=e.parents(".messages-container");e.css("top",t.offset().top-n.offset().top),e.css("height",t.height()),e.css("line-height",t.height()+"px")})}function d(){var e=c(".sensbitinpost-orders-selected-container");if(e.length){var t=c(".sensbitinpost .package input[name='checked']:checked").length;c(".sensbitinpost .package.error input[name='checked']:checked").length?(e.find(".prepare-packs").hide(),e.find(".next-error").fadeIn().css("display","block")):(e.find(".next-error").hide(),e.find(".prepare-packs").fadeIn().css("display","block")),e.find(".n").text(t),0<t?e.css("top","0px"):e.removeAttr("style")}}c(function(){c(document).ajaxSuccess(function(e,t,n){!function(e,t){if(void 0!==t.url&&0<=t.url.toLowerCase().search(a.module)){try{void 0===e.responseJSON&&(e.responseJSON=JSON.parse(e.responseText))}catch(e){}void 0!==e.responseJSON&&void 0!==e.responseJSON.callback&&c(e.responseJSON.callback).each(function(e,t){for(var n in t)void 0===a.callback_queue[n]&&(a.callback_queue[n]=[]),a.callback_queue[n].push(t[n])})}}(t,n)}),setInterval(function(){if(0==c.active){for(var e in a.callback_queue)"function"==typeof window[a.module][e]&&window[a.module][e].apply(null,[c.unique(a.callback_queue[e])]);a.callback_queue={}}},1e3),c.fn.tooltip&&(c(".sensbitinpost-tip").each(function(){c(this).closest(".sensbitinpost").length<=0&&c(this).parent().addClass("sensbitinpost")}),c(".sensbitinpost-tip").tooltip({html:!0})),c.fn.datetimepicker&&c(".sensbitinpost-datetime").datetimepicker({prevText:"",nextText:"",dateFormat:"yy-mm-dd",timeFormat:"hh:mm:ss"}),c(".sensbitinpost-map-container").remove(),c("body").append("<div class='sensbitinpost-map-container'><div id='sensbiteasypack-map'></div></div>"),c(document).on("click",".sensbitinpost-map-container",function(e){c(e.target).parents(".sensbitinpost-map-container").length||(c(this).fadeOut(),c(".sensbitinpost-map-container .easypack-widget").html(""))}),c(document).on("change","#sensbitinpost_pickup_sender_point",function(){p.checkPredefinedPlace()}),c("#sensbitinpost_pickup_sender_point").trigger("change"),c(document).on("click",".sensbitinpost-service",function(e){e.preventDefault(),p.createServicePackage(c(this).data("id"))});var e=c(".sensbitinpost-pack-status[data-autocheck=1]").map(function(){return c(this).data("id-shipment")}).get();0<e.length&&p.getPackStatus(e);var t=c(".sensbitinpost-dispatch-status[data-autocheck=1]").map(function(){return c(this).data("id_dispatch_order")}).get();0<t.length&&p.getDispatchStatus(t),c(document).on("change",".sensbitinpost .package input[name='checked']",d),c(document).on("change",".sensbitinpost-service-order-select",function(e){c(".sensbitinpost-service-order-btn[data-id_order="+c(this).data("id_order")+"]").data("id_template",c(this).val())}),c(document).on("click",".sensbitinpost-service-order-btn",function(e){e.preventDefault(),p.createServiceOrderPackage(c(this).data("id_order"),c(this).data("id_template"))}),c(document).on("click",".sensbitinpost-orders-selected-container .next-error",function(e){c("html, body").animate({scrollTop:c(".sensbitinpost .package.error").eq(0).offset().top-150},500)}),c(document).on("click",".sensbitinpost-mass-open",function(e){e.preventDefault(),c(".sensbitinpost-service-order-btn").trigger("click")}),c(document).on("click",".sensbitinpost-mass-add",function(e){e.preventDefault(),c(".sensbitinpost-service-order-btn").trigger("click");var t=setInterval(function(){c.active<=0&&(c(".sensbitinpost .prepare-packs").trigger("click"),clearInterval(t))},500)}),c(document).on("click",".sensbitinpost .prepare-packs",function(e){var t=c(this);e.preventDefault(),t.prop("disabled",!0),c(".sensbitinpost .package-options").hide(),p.addSelectedPackages(),setTimeout(function(){t.prop("disabled",!1)},1e3)}),c(document).on("click",".sensbitinpost .print-labels",function(e){e.preventDefault();var t=[];c(".sensbitinpost .completed-packs:checked").each(function(){c.isNumeric(c(this).val())&&t.push(c(this).val())}),p.printLabels(t)}),c(document).on("click",".sensbitinpost-bulk-labels",function(e){e.preventDefault();var t=[];c(".sensbitinpost_shipment input:checked").each(function(){c.isNumeric(c(this).val())&&t.push(c(this).val())}),p.printLabels(t)}),c(document).on("click",".sensbitinpost-bulk-protocol",function(e){e.preventDefault();var t=[];c(".sensbitinpost_shipment input:checked").each(function(){c.isNumeric(c(this).val())&&t.push(c(this).val())}),p.printProtocol(t)}),c(document).on("click",".sensbitinpost-bulk-select-all",function(e){e.preventDefault(),c(".sensbitinpost_shipment input").prop("checked",!0)}),c(document).on("click",".sensbitinpost-bulk-select-none",function(e){e.preventDefault(),c(".sensbitinpost_shipment input").prop("checked",!1)}),c(document).on("click",".sensbitinpost-order-carrier-print-protocol",function(e){e.preventDefault();var t=[];c("input[name='sensbitinpost_shipmentBox[]']:checked").each(function(){c.isNumeric(c(this).val())&&t.push(c(this).val())}),p.printProtocol(t)}),c(document).on("click",".sensbitinpost-order-carrier-print-protocol-send",function(e){e.preventDefault();var t=[];c("input[name='sensbitinpost_shipmentBox[]']:checked").each(function(){c.isNumeric(c(this).val())&&t.push(c(this).val())}),p.printProtocol(t,1)}),c(document).on("click",".sensbitinpost .delete-shipments",function(e){e.preventDefault();var t=[];c(".sensbitinpost .completed-packs:checked").each(function(){c.isNumeric(c(this).val())&&t.push(c(this).val())}),p.deleteShipments(t)}),c(document).on("click",".sensbitinpost .messages-container .message",function(){c(this).closest(".package").removeClass("error"),c(this).fadeOut()}),c(document).on("click",".sensbitinpost .switch_global_templates",function(e){e.preventDefault(),c(this).closest(".sensbitinpost").toggleClass("hide_global_templates")}),c(document).on("click",".sensbitinpost .switch_no_templates",function(e){e.preventDefault(),c(this).closest(".sensbitinpost").toggleClass("hide_no_templates")}),c(document).on("click",".sensbitinpost-orders-filters-open",function(e){e.preventDefault();var t=c(".sensbitinpost-orders-filters .filters-container");t.toggleClass("open"),t.hasClass("open")?c(this).text("Zwiń ⇈"):c(this).text("Rozwiń ⇊")}),c(document).on("click",".sensbitinpost-slide-toggle",function(e){e.preventDefault();var t=c(this),n=t.attr("href");c(n).length&&c(n).slideToggle(400,function(){c(n).is(":visible")?t.html("Ukryj"):t.html("Pokaż")})}),0<parseInt(c("input[name='filters[autosendsingle]']:checked").val())&&1===c(".sensbitinpost-service-order-btn").length&&c("input[name='filters[orders][]'][value='noshipments']").is(":checked")&&(showNoticeMessage("Automatyczne dodawanie etykiety rozpoczęte!"),c(".sensbitinpost-mass-add").trigger("click")),0<parseInt(c("input[name='filters[autoprintsingle]']:checked").val())&&1===c(".sensbitinpost-print-label").length&&(showNoticeMessage("Automatyczne drukowanie etykiety rozpoczęte!"),c(".sensbitinpost-print-label:visible").trigger("click")),c(document).on("click",".sensbitinpost-orders-open-tab",function(e){e.preventDefault(),c(".sensbitinpost-order-link").each(function(){var e=c(this).attr("href");window.open(e,"_blank")})}),c(document).on("click",".sensbitinpost-hide-today-orders",function(){c(".sensbitinpost-set-filters").trigger("click")})});var p={setOptions:function(e){c.extend(a,e),c(function(){a.open_single_template&&c(".sensbitinpost-connected-templates").length&&(a.open_single_template=!1,1===c(".sensbitinpost-connected-templates .sensbitinpost-service:visible").length&&c(".sensbitinpost-connected-templates .sensbitinpost-service:visible").first().trigger("click"))})},setIdOrder:function(e){this.id_order=e},showAlert:function(e){c.prototype.fancybox?c.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:'<p class="fancybox-error">'+e+"</p>"}],{padding:0,helpers:{overlay:{locked:!1}}}):alert(e)},bindEventsToPackage:function(e){var n=c(".sensbitinpost #package_"+e),t=c(".sensbitinpost #package_options_"+e);n.find(".param").each(function(){c(this).attr("title",c(this).attr("placeholder"))}),c.fn.tooltip&&n.find(".param").tooltip(),n.find(".edit-address").click(function(e){e.preventDefault(),$addr_text=c(this).closest(".address"),$addr_edit=$addr_text.next(".address-edit"),$addr_text.hide(),$addr_edit.fadeIn()}),n.find(".save-address").click(function(e){e.preventDefault(),$addr_edit=c(this).closest(".address-edit"),$addr_text=$addr_edit.prev(".address"),$addr_text.find("div").html([$addr_edit.find("input[name=company]").val(),$addr_edit.find("input[name=firstname]").val()+" "+$addr_edit.find("input[name=lastname]").val(),$addr_edit.find("input[name=street]").val()+" "+$addr_edit.find("input[name=building_number]").val(),$addr_edit.find("input[name=postcode]").val()+" "+$addr_edit.find("input[name=city]").val()].filter(function(e){return 0<e.length}).join("<br/>")),$addr_text.fadeIn(),$addr_edit.hide()}),n.find(".remove-package").click(function(e){e.preventDefault(),n.fadeOut(400,function(){n.closest("table").find(".package").length<=1&&(n.closest("table").hide(),n.closest(".packages-form").hide()),n.remove(),d()})}),n.find(".message").click(function(){n.removeClass("error"),c(this).fadeOut(),d()}),n.find(".sending-method").change(function(){"parcel_locker"==c(this).val()?n.find(".dropoff-point-container").fadeIn():n.find(".dropoff-point-container").fadeOut()}),n.find(".sending-method").trigger("change"),n.find(".show-options").on("click",function(e){e.preventDefault(),t.is(":visible")?(t.fadeOut(),n.removeClass("options-visible")):(t.fadeIn(),n.addClass("options-visible"))}),n.on("click",".copy",function(e){e.preventDefault(),c(this).closest(".subpackage").clone(!1).appendTo(n.find(".subpackages"));var t=1;n.find(".subpackage").each(function(){c(this).find(".number input").val(t++)}),c.fn.tooltip&&n.find(".subpackage .package-param").tooltip()}),n.on("click",".subpackage .remove",function(e){e.preventDefault(),c(this).closest(".subpackage").fadeOut(400,function(){c(this).remove();var e=1;n.find(".subpackage").each(function(){c(this).find(".number input").val(e++)})})})},openMap:function(e){SensbitInpostEasyPack.init({defaultLocale:"pl",closeTooltip:!0,points:{types:["parcel_locker_only"]},map:{googleKey:a.google_key,initialTypes:["parcel_locker_only"]},closestLimit:500});SensbitInpostEasyPack.mapWidget("sensbiteasypack-map",function(t){c(e).each(function(){var e=c(this);e.hasClass(".paczkomat-select")||e.val(t.name)}),c(".sensbitinpost-map-container").fadeOut(),c(".sensbitinpost-map-container .easypack-widget").html("")});c(".sensbitinpost-map-container").fadeIn()},update:function(){c.ajax({type:"POST",data:{ajax:1,sensbitinpost:1,action:"update"},beforeSend:function(){showNoticeMessage("Aktualizacja bazy danych modułu Inpost")},error:function(e,t,n){showErrorMessage(t)},success:function(e){void 0!==e.errors?showErrorMessage(e.errors.join(", ")):showSuccessMessage("Aktualizacja bazy danych Inpost przebiegła pomyślnie")}})},createServiceOrderPackage:function(i,e){var s=i+"_"+a.next_package_id,o=0<c("#sensbitinpost-order-form-"+i).length?0:1;c.ajax({type:"POST",url:a.ajax_url_packages,data:{ajax:1,action:"getNewPackageForm",id_template:e,id_order:i,uniq:s,full:o},beforeSend:function(){++a.next_package_id},success:function(e){if(o){var t=c(".sensbitinpost-service-order-select[data-id_order="+i+"]").closest("tr"),n=t.find("td").length,a=c("<tr><td colspan='"+n+" style='padding:0'></td></tr>");a.addClass(t.attr("class")),a.find("td").append(e),t.after(a)}else c("#sensbitinpost-order-form-"+i).fadeIn(),c("#sensbitinpost-order-form-"+i).find(".package-container").append(e);p.bindEventsToPackage(s),d()}})},createServicePackage:function(e){var t=a.id_order+"_"+a.next_package_id;c.ajax({type:"POST",url:a.ajax_url_packages,data:{ajax:1,action:"getNewPackageForm",id_template:e,id_order:a.id_order,uniq:t},beforeSend:function(){++a.next_package_id},success:function(e){c(".sensbitinpost .packages-form table:hidden").show(),c(".sensbitinpost .packages-form:hidden").fadeIn(),c(".sensbitinpost .package-container").append(e),p.bindEventsToPackage(t)}})},addSelectedPackages:function(){var o,e=(o=[],c(".sensbitinpost .package input[name='checked']:checked").each(function(e,t){var n=c(t).closest(".package"),a=c(".sensbitinpost #package_options_"+n.data("id")),i=r(n);c.extend(i,r(a));var s=[];n.find(".subpackage").each(function(){var t={};c(this).find(".param").each(function(){var e="";e=c(this).is(":checkbox")?c(this).is(":checked")?1:0:c(this).val(),t[c(this).attr("name")]=e}),s.push(t)}),c.extend(i,{subpackages:s}),o.push(i)}),o);e.length<=0?p.showAlert("Nie wybrano żadnych paczek"):c(e).each(function(){var e=this,t=c(".sensbitinpost #package_"+e.uniq),n=[];(e.email.length<=0||!validate_isEmail(e.email))&&n.push("Nie podano lub błędny adres email"),(e.phone.length<=0||9<e.phone.length||!validate_isPhoneNumber(e.phone))&&n.push("Błędny numer kontaktowy"),void 0!==e.target_point&&e.target_point.length<=0&&n.push("Nie wybrano paczkomatu odbiorcy"),e.reference.length<3&&n.push("Opis przesyłki jest za krótki. Minimum 3 znaki."),"parcel_locker"===e.sending_method&&e.dropoff_point.length<=0&&n.push("Nie wybrano paczkomatu nadawcy"),1==e.is_cod&&parseFloat(e.cod_value)<=0&&n.push("Nieprawidłowa kwota pobrania"),"inpost_letter_ecommerce"!=e.service&&"inpost_letter_allegro"!=e.service&&"inpost_courier_standard"!=e.service||(e.firstname.length<=0&&n.push("Błędne imię odbiorcy"),e.lastname.length<=0&&n.push("Błędne nazwisko odbiorcy"),e.street.length<=0&&n.push("Nie podano ulicy odbiorcy"),e.building_number.length<=0&&n.push("Nie podano numeru domu odbiorcy"),(e.postcode.length<6||6<e.postcode.length)&&n.push("Kod pocztowy odbiorcy jest nieprawidłowy"),e.city.length<=0&&n.push("Błędne miasto odbiorcy")),1==e.is_allegro&&(e.allegro_user_id.length<=0&&n.push("Nie podano id konta allegro"),e.allegro_transaction_id.length<=0&&n.push("Nie podano id transakcji allegro")),n.length?(t.addClass("error"),i(t,"Popraw następujące błędy: "+n.join(", "),"danger"),d()):c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"sendPackage",pack:e,mass:!0===a.mass_page?1:0},beforeSend:function(e){t.removeClass("error"),i(t,"Trwa przygotowywanie przesyłki","warning")},success:function(e){void 0!==e.errors?(t.addClass("error"),i(t,e.errors.join(", "),"danger",!1),d()):(t.find("input[name=id_shipment]").val(e.id_shipment),void 0!==e.next_action&&"checkOffer"===e.next_action&&p.checkOffersForPackage(t))}})})},checkOffersForPackage:function(t){var e=t.find("input[name=id_shipment]").val();c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"checkOffer",id_shipment:e,pack:r(t)},beforeSend:function(e){i(t,"Generowanie listu przewozowego","warning")},success:function(e){void 0!==e.errors?i(t,e.errors.join(", "),"danger",!1):(void 0!==e.next_action&&"checkOffer"===e.next_action&&setTimeout(function(){p.checkOffersForPackage(t)},500),void 0!==e.status&&"completed"==e.status&&(c(".sensbitinpost .packages-ready-form:hidden").fadeIn(),c(".sensbitinpost .packages-ready-container:hidden").fadeIn(),c(".sensbitinpost .packages-ready-container").append(e.pack),void 0!==e.tracking_number&&(c(".sensbitinpost-shipment-list[data-id_order="+e.id_order+"]").append('<a class="sensbitinpost-tip" title="Pobiera etykietę dla przesyłki o nr '+e.tracking_number+'" href="#" style="color:#0c0;" onclick="sensbitinpost.printLabels('+e.id_shipment+');return false;">'+e.tracking_number+"</a>"),c.fn.tooltip&&c(".sensbitinpost-shipment-list .sensbitinpost-tip").tooltip()),t.fadeOut(400,function(){t.closest("table").find(".package").length<=1&&(t.closest("table").hide(),t.closest(".packages-form").hide()),t.remove(),d()}),a.reload_page&&setTimeout(function(){var e=setInterval(function(){0==c.active&&(clearInterval(e),window.location.reload())},500)},1e3),a.next_order&&setTimeout(function(){var e=setInterval(function(){0==c.active&&(clearInterval(e),window.location.href=a.next_order_link)},500)},1e3))),d()}})},printLabels:function(e){c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"printLabels",id_shipment:e},beforeSend:function(e){showSuccessMessage("Generowanie etykiet")},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join("<br/>")):c.each(e.files,function(e,t){var n=a.ajax_url_packages+"&ajax=1&action=getLabelFile&file="+t.file+"&filename="+t.filename+"&format="+t.format;c("<iframe></iframe>").hide().attr("src",n).appendTo(c("body")).load(function(){var e=this;setTimeout(function(){c(e).remove()},100)})})}})},printReturnLabels:function(e){c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"printReturnLabels",id_shipment:e},beforeSend:function(e){showSuccessMessage("Generowanie etykiet zwrotnych")},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join("<br/>")):c.each(e.files,function(e,t){var n=a.ajax_url_packages+"&ajax=1&action=getLabelFile&file="+t.file+"&filename="+t.filename+"&format="+t.format;c("<iframe></iframe>").hide().attr("src",n).appendTo(c("body")).load(function(){var e=this;setTimeout(function(){c(e).remove()},100)})})}})},printNode:function(e){c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"printNode",id_shipment:e},beforeSend:function(e){showSuccessMessage("Wysyłanie etykiet do usługi PrintNode.com")},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join("<br/>")):showSuccessMessage("Wysyłanie etykiet do usługi PrintNode.com przebiegło pomyślnie.")}})},printLabelsByDispatchId:function(e){c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"printLabelsByDispatchId",id_dispatch_order:e},beforeSend:function(e){showSuccessMessage("Generowanie etykiet na podstawie zlecenia")},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join(", ")):window.location=a.ajax_url_packages+"&ajax=1&action=getLabelFile&file="+e.file+"&filename="+e.filename+"&format="+e.format}})},printProtocol:function(t,n){void 0===n&&(n=0),c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"printProtocol",id_shipment:t,send:n},beforeSend:function(e){showSuccessMessage("Generowanie druku potwierdzenia nadania")},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join(", ")):(c.each(e.files,function(e,t){var n=a.ajax_url_packages+"&ajax=1&action=getLabelFile&file="+t.file+"&filename="+t.filename+"&format="+t.format;c("<iframe></iframe>").hide().attr("src",n).appendTo(c("body")).load(function(){var e=this;setTimeout(function(){c(e).remove()},100)})}),0<n&&c.each(t,function(e,t){var n=c("input[name='sensbitinpost_shipmentBox[]'][value="+this+"]");n.length&&n.closest("tr").fadeOut(400,function(){c(this).remove()})}))}})},printProtocolByDispatchId:function(e){c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"printProtocolByDispatchId",id_dispatch_order:e},beforeSend:function(e){showSuccessMessage("Generowanie druku potwierdzenia nadania na podstawie zlecenia")},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join(", ")):c.each(e.files,function(e,t){var n=a.ajax_url_packages+"&ajax=1&action=getLabelFile&file="+t.file+"&filename="+t.filename+"&format="+t.format;c("<iframe></iframe>").hide().attr("src",n).appendTo(c("body")).load(function(){var e=this;setTimeout(function(){c(e).remove()},100)})})}})},getPackStatus:function(t){t instanceof Array||(t=[t]),c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"getPackStatus",id_shipment:t},beforeSend:function(e){c.each(t,function(){c(".sensbitinpost-pack-status[data-id-shipment="+this+"]").removeClass("new old").addClass("check")})},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join(", ")):c.each(e.data,function(e,t){var n=c(".sensbitinpost-pack-status[data-id-shipment="+e+"]"),a=n.text();void 0!==t.status?a!==t.status?(n.text(t.status),n.removeClass("check old").addClass("new"),showSuccessMessage("Przesyłka "+t.tracking_number+" otrzymała nowy status: "+t.status)):n.removeClass("check new").addClass("old"):(showErrorMessage(t+" "+e),n.removeClass("check new").addClass("old"))})}})},getDispatchStatus:function(t){t instanceof Array||(t=[t]),c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"getDispatchStatus",id_dispatch_order:t},beforeSend:function(e){c.each(t,function(){c(".sensbitinpost-dispatch-status[data-id_dispatch_order="+this+"]").removeClass("new old").addClass("check")})},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join(", ")):c.each(e.data,function(e,t){var n=c(".sensbitinpost-dispatch-status[data-id_dispatch_order="+e+"]");n.text()!==t.status?(n.text(t.status),n.removeClass("check old").addClass("new"),showSuccessMessage("Zlecenie odbioru "+t.dispatch_order+" otrzymało nowy status: "+t.status)):n.removeClass("check new").addClass("old")})}})},deleteShipments:function(e){c.isArray(e)||(e=[e]),c(e).each(function(){var e=parseInt(this),t=c(".sensbitinpost #shipment_"+e);c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"deleteShipment",id_shipment:e},beforeSend:function(e){i(t,"Trwa anulowanie przesyłki","warning",!1)},success:function(e){void 0!==e.errors?i(t,e.errors.join(", "),"danger"):(i(t,"Przesyłka została anulowana i usunięta z systemu","success"),t.find(".message").click(function(){t.fadeOut(400,function(){c(this).remove()})}))}})})},initSwitches:function(e){function i(){e.forEach(function(e){!function(e,t,n){var a=parseInt(t);t=a<=0||isNaN(t)?"":":lt("+a+")";var i=c(e+":checked").val();if(""===t)var s=c(e).closest("div.form-group").not(".blocked").nextAll("div.form-group");else var s=c(e).closest("div.form-group").not(".blocked").nextAll(t);c(e).closest(".sensbitinpost-switch-container").length||s.add(c(e).closest("div.form-group").not(".blocked")).wrapAll('<div class="sensbitinpost-switch-container"></div>');var o=c(e).closest(".sensbitinpost-switch-container");i==n?(s.slideDown(),o.addClass("open")):(s.slideUp(),o.removeClass("open"))}(e[0],e[1],e[2])})}e=c.map(e,function(e){var t=e[0],n=e[1],a=e[2];return c("input[name="+t+"]").on("change",function(){i()}),[["input[name="+t+"]",n,a]]}),i()},checkPredefinedPlace:function(){var e=c("#sensbitinpost_pickup_sender_point :selected");if(e.length){var t=e.data("json");void 0!==t&&(c("input[name='pickup_sender_name'").css("opacity",0).val(t.pickup_sender_name).animate({opacity:1},300),c("input[name='address[street]'").css("opacity",0).val(t.address).animate({opacity:1},300),c("input[name='address[building_number]'").css("opacity",0).val(t.building_number).animate({opacity:1},300),c("input[name='address[post_code]'").css("opacity",0).val(t.post_code).animate({opacity:1},300),c("input[name='address[city]'").css("opacity",0).val(t.city).animate({opacity:1},300),c("input[name='address[country_code]'").css("opacity",0).val(t.country_code).animate({opacity:1},300))}},updateShippingTable:function(e){var t=c("#shipping_table");t.length&&c.ajax({type:"POST",url:a.ajax_url_packages,dataType:"json",data:{ajax:1,action:"getShippingTable",id_order:e},beforeSend:function(e){showSuccessMessage("Aktualizowanie tabeli przewoźników")},success:function(e){void 0!==e.errors?p.showAlert(e.errors.join(", ")):void 0!==e.content&&(t.find("tbody").html(e.content),showSuccessMessage("Tabela przewoźników została zaktualizowana."))}})}};return p}($,window,document);